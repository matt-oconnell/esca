!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("esca",[],e):"object"==typeof exports?exports.esca=e():t.esca=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){(function(e){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}var o=r(1),i=n(o);t.exports=e.esca=new i["default"]}).call(e,function(){return this}())},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(2),u=n(s),a=r(9),c=function(){function t(){o(this,t);var e=a.parse(location.search);if(!e.iid)throw new Error("esca SDK has not been properly configured through the esca Dashboard.");this.iid=e.iid,this.authenticate()}return i(t,[{key:"authenticate",value:function(){u["default"].test()}}]),t}();e["default"]=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(r(3),r(8)),o={test:function(){n("/esca/example/fake.php",function(t,e){if(!t)return console.log("browser-request got your root path:\n"+e.body);throw console.log("There was an error, but at least browser-request loaded and ran!"),t})}};e["default"]=o},function(t,e,r){var n;(function(t,o,i){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
	 * @version   3.1.2
	 */
(function(){"use strict";function s(t){return"function"==typeof t||"object"==typeof t&&null!==t}function u(t){return"function"==typeof t}function a(t){K=t}function c(t){Q=t}function f(){return function(){t.nextTick(y)}}function l(){return function(){z(y)}}function d(){var t=0,e=new tt(y),r=document.createTextNode("");return e.observe(r,{characterData:!0}),function(){r.data=t=++t%2}}function p(){var t=new MessageChannel;return t.port1.onmessage=y,function(){t.port2.postMessage(0)}}function h(){return function(){setTimeout(y,1)}}function y(){for(var t=0;W>t;t+=2){var e=nt[t],r=nt[t+1];e(r),nt[t]=void 0,nt[t+1]=void 0}W=0}function v(){try{var t=r(6);return z=t.runOnLoop||t.runOnContext,l()}catch(e){return h()}}function g(t,e){var r=this,n=r._state;if(n===ut&&!t||n===at&&!e)return this;var o=new this.constructor(m),i=r._result;if(n){var s=arguments[n-1];Q(function(){N(n,o,s,i)})}else k(r,o,t,e);return o}function w(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var r=new e(m);return T(r,t),r}function m(){}function b(){return new TypeError("You cannot resolve a promise with itself")}function _(){return new TypeError("A promises callback cannot return that same promise.")}function E(t){try{return t.then}catch(e){return ct.error=e,ct}}function A(t,e,r,n){try{t.call(e,r,n)}catch(o){return o}}function j(t,e,r){Q(function(t){var n=!1,o=A(r,e,function(r){n||(n=!0,e!==r?T(t,r):S(t,r))},function(e){n||(n=!0,R(t,e))},"Settle: "+(t._label||" unknown promise"));!n&&o&&(n=!0,R(t,o))},t)}function C(t,e){e._state===ut?S(t,e._result):e._state===at?R(t,e._result):k(e,void 0,function(e){T(t,e)},function(e){R(t,e)})}function O(t,e,r){e.constructor===t.constructor&&r===ot&&constructor.resolve===it?C(t,e):r===ct?R(t,ct.error):void 0===r?S(t,e):u(r)?j(t,e,r):S(t,e)}function T(t,e){t===e?R(t,b()):s(e)?O(t,e,E(e)):S(t,e)}function x(t){t._onerror&&t._onerror(t._result),M(t)}function S(t,e){t._state===st&&(t._result=e,t._state=ut,0!==t._subscribers.length&&Q(M,t))}function R(t,e){t._state===st&&(t._state=at,t._result=e,Q(x,t))}function k(t,e,r,n){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+ut]=r,o[i+at]=n,0===i&&t._state&&Q(M,t)}function M(t){var e=t._subscribers,r=t._state;if(0!==e.length){for(var n,o,i=t._result,s=0;s<e.length;s+=3)n=e[s],o=e[s+r],n?N(r,n,o,i):o(i);t._subscribers.length=0}}function P(){this.error=null}function q(t,e){try{return t(e)}catch(r){return ft.error=r,ft}}function N(t,e,r,n){var o,i,s,a,c=u(r);if(c){if(o=q(r,n),o===ft?(a=!0,i=o.error,o=null):s=!0,e===o)return void R(e,_())}else o=n,s=!0;e._state!==st||(c&&s?T(e,o):a?R(e,i):t===ut?S(e,o):t===at&&R(e,o))}function U(t,e){try{e(function(e){T(t,e)},function(e){R(t,e)})}catch(r){R(t,r)}}function D(t){return new vt(this,t).promise}function I(t){function e(t){T(o,t)}function r(t){R(o,t)}var n=this,o=new n(m);if(!V(t))return R(o,new TypeError("You must pass an array to race.")),o;for(var i=t.length,s=0;o._state===st&&i>s;s++)k(n.resolve(t[s]),void 0,e,r);return o}function L(t){var e=this,r=new e(m);return R(r,t),r}function J(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function F(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function B(t){this._id=ht++,this._state=void 0,this._result=void 0,this._subscribers=[],m!==t&&("function"!=typeof t&&J(),this instanceof B?U(this,t):F())}function G(t,e){this._instanceConstructor=t,this.promise=new t(m),Array.isArray(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&S(this.promise,this._result))):R(this.promise,this._validationError())}function H(){var t;if("undefined"!=typeof o)t=o;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var r=t.Promise;r&&"[object Promise]"===Object.prototype.toString.call(r.resolve())&&!r.cast||(t.Promise=yt)}var Y;Y=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var z,K,X,V=Y,W=0,Q=function(t,e){nt[W]=t,nt[W+1]=e,W+=2,2===W&&(K?K(y):X())},Z="undefined"!=typeof window?window:void 0,$=Z||{},tt=$.MutationObserver||$.WebKitMutationObserver,et="undefined"!=typeof t&&"[object process]"==={}.toString.call(t),rt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,nt=new Array(1e3);X=et?f():tt?d():rt?p():void 0===Z?v():h();var ot=g,it=w,st=void 0,ut=1,at=2,ct=new P,ft=new P,lt=D,dt=I,pt=L,ht=0,yt=B;B.all=lt,B.race=dt,B.resolve=it,B.reject=pt,B._setScheduler=a,B._setAsap=c,B._asap=Q,B.prototype={constructor:B,then:ot,"catch":function(t){return this.then(null,t)}};var vt=G;G.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},G.prototype._enumerate=function(){for(var t=this.length,e=this._input,r=0;this._state===st&&t>r;r++)this._eachEntry(e[r],r)},G.prototype._eachEntry=function(t,e){var r=this._instanceConstructor,n=r.resolve;if(n===it){var o=E(t);if(o===ot&&t._state!==st)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(r===yt){var i=new r(m);O(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new r(function(e){e(t)}),e)}else this._willSettleAt(n(t),e)},G.prototype._settledAt=function(t,e,r){var n=this.promise;n._state===st&&(this._remaining--,t===at?R(n,r):this._result[e]=r),0===this._remaining&&S(n,this._result)},G.prototype._willSettleAt=function(t,e){var r=this;k(t,void 0,function(t){r._settledAt(ut,e,t)},function(t){r._settledAt(at,e,t)})};var gt=H,wt={Promise:yt,polyfill:gt};r(7).amd?(n=function(){return wt}.call(e,r,e,i),!(void 0!==n&&(i.exports=n))):"undefined"!=typeof i&&i.exports?i.exports=wt:"undefined"!=typeof this&&(this.ES6Promise=wt),gt()}).call(this)}).call(e,r(4),function(){return this}(),r(5)(t))},function(t,e){function r(){c&&s&&(c=!1,s.length?a=s.concat(a):f=-1,a.length&&n())}function n(){if(!c){var t=setTimeout(r);c=!0;for(var e=a.length;e;){for(s=a,a=[];++f<e;)s&&s[f].run();f=-1,e=a.length}s=null,c=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function i(){}var s,u=t.exports={},a=[],c=!1,f=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];a.push(new o(t,e)),1!==a.length||c||setTimeout(n,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=i,u.addListener=i,u.once=i,u.off=i,u.removeListener=i,u.removeAllListeners=i,u.emit=i,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,r){var n,o,i;!function(r,s){o=[],n=s,i="function"==typeof n?n.apply(e,o):n,!(void 0!==i&&(t.exports=i))}(this,function(){function t(o,i){if("function"!=typeof i)throw new Error("Bad callback given: "+i);if(!o)throw new Error("No options given");var u=o.onResponse;if(o="string"==typeof o?{uri:o}:JSON.parse(JSON.stringify(o)),o.onResponse=u,o.verbose&&(t.log=n()),o.url&&(o.uri=o.url,delete o.url),!o.uri&&""!==o.uri)throw new Error("options.uri is a required argument");if("string"!=typeof o.uri)throw new Error("options.uri must be a string");for(var a=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],c=0;c<a.length;c++)if(o[a[c]])throw new Error("options."+a[c]+" is not supported");if(o.callback=i,o.method=o.method||"GET",o.headers=o.headers||{},o.body=o.body||null,o.timeout=o.timeout||t.DEFAULT_TIMEOUT,o.headers.host)throw new Error("Options.headers.host is not supported");o.json&&(o.headers.accept=o.headers.accept||"application/json","GET"!==o.method&&(o.headers["content-type"]="application/json"),"boolean"!=typeof o.json?o.body=JSON.stringify(o.json):"string"!=typeof o.body&&(o.body=JSON.stringify(o.body)));var f=function(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e.join("&")};if(o.qs){var l="string"==typeof o.qs?o.qs:f(o.qs);-1!==o.uri.indexOf("?")?o.uri=o.uri+"&"+l:o.uri=o.uri+"?"+l}var d=function(t){var e={};e.boundry="-------------------------------"+Math.floor(1e9*Math.random());var r=[];for(var n in t)t.hasOwnProperty(n)&&r.push("--"+e.boundry+'\nContent-Disposition: form-data; name="'+n+'"\n\n'+t[n]+"\n");return r.push("--"+e.boundry+"--"),e.body=r.join(""),e.length=e.body.length,e.type="multipart/form-data; boundary="+e.boundry,e};if(o.form){if("string"==typeof o.form)throw"form name unsupported";if("POST"===o.method){var p=(o.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(o.headers["content-type"]=p,p){case"application/x-www-form-urlencoded":o.body=f(o.form).replace(/%20/g,"+");break;case"multipart/form-data":var h=d(o.form);o.body=h.body,o.headers["content-type"]=h.type;break;default:throw new Error("unsupported encoding:"+p)}}}return o.onResponse=o.onResponse||r,o.onResponse===!0&&(o.onResponse=i,o.callback=r),!o.headers.authorization&&o.auth&&(o.headers.authorization="Basic "+s(o.auth.username+":"+o.auth.password)),e(o)}function e(e){function r(){l=!0;var r=new Error("ETIMEDOUT");return r.code="ETIMEDOUT",r.duration=e.timeout,t.log.error("Timeout",{id:f._id,milliseconds:e.timeout}),e.callback(r,f)}function n(r){if(l)return t.log.debug("Ignoring timed out state change",{state:f.readyState,id:f.id});if(t.log.debug("State change",{state:f.readyState,id:f.id,timed_out:l}),f.readyState===u.OPENED){t.log.debug("Request started",{id:f.id});for(var n in e.headers)f.setRequestHeader(n,e.headers[n])}else f.readyState===u.HEADERS_RECEIVED?o():f.readyState===u.LOADING?(o(),s()):f.readyState===u.DONE&&(o(),s(),a())}function o(){if(!y.response){if(y.response=!0,t.log.debug("Got response",{id:f.id,status:f.status}),clearTimeout(f.timeoutTimer),f.statusCode=f.status,d&&0==f.statusCode){var r=new Error("CORS request rejected: "+e.uri);return r.cors="rejected",y.loading=!0,y.end=!0,e.callback(r,f)}e.onResponse(null,f)}}function s(){y.loading||(y.loading=!0,t.log.debug("Response body loading",{id:f.id}))}function a(){if(!y.end){if(y.end=!0,t.log.debug("Request done",{id:f.id}),f.body=f.responseText,e.json)try{f.body=JSON.parse(f.responseText)}catch(r){return e.callback(r,f)}e.callback(null,f,f.body)}}var f=new u,l=!1,d=i(e.uri),p="withCredentials"in f;if(c+=1,f.seq_id=c,f.id=c+": "+e.method+" "+e.uri,f._id=f.id,d&&!p){var h=new Error("Browser does not support cross-origin request: "+e.uri);return h.cors="unsupported",e.callback(h,f)}f.timeoutTimer=setTimeout(r,e.timeout);var y={response:!1,loading:!1,end:!1};return f.onreadystatechange=n,f.open(e.method,e.uri,!0),d&&(f.withCredentials=!!e.withCredentials),f.send(e.body),f}function r(){}function n(){var t,e,n={},i=["trace","debug","info","warn","error"];for(e=0;e<i.length;e++)t=i[e],n[t]=r,"undefined"!=typeof console&&console&&console[t]&&(n[t]=o(console,t));return n}function o(t,e){function r(r,n){return"object"==typeof n&&(r+=" "+JSON.stringify(n)),t[e].call(t,r)}return r}function i(t){var e,r=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{e=location.href}catch(n){e=document.createElement("a"),e.href="",e=e.href}var o=r.exec(e.toLowerCase())||[],i=r.exec(t.toLowerCase()),s=!(!i||i[1]==o[1]&&i[2]==o[2]&&(i[3]||("http:"===i[1]?80:443))==(o[3]||("http:"===o[1]?80:443)));return s}function s(t){var e,r,n,o,i,s,u,a,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0,l=0,d="",p=[];if(!t)return t;do e=t.charCodeAt(f++),r=t.charCodeAt(f++),n=t.charCodeAt(f++),a=e<<16|r<<8|n,o=a>>18&63,i=a>>12&63,s=a>>6&63,u=63&a,p[l++]=c.charAt(o)+c.charAt(i)+c.charAt(s)+c.charAt(u);while(f<t.length);switch(d=p.join(""),t.length%3){case 1:d=d.slice(0,-2)+"==";break;case 2:d=d.slice(0,-1)+"="}return d}var u=XMLHttpRequest;if(!u)throw new Error("missing XMLHttpRequest");t.log={trace:r,debug:r,info:r,warn:r,error:r};var a=18e4,c=0;t.withCredentials=!1,t.DEFAULT_TIMEOUT=a,t.defaults=function(e,r){var n=function(t){var r=function(r,n){r="string"==typeof r?{uri:r}:JSON.parse(JSON.stringify(r));for(var o in e)void 0===r[o]&&(r[o]=e[o]);return t(r,n)};return r},o=n(t);return o.get=n(t.get),o.post=n(t.post),o.put=n(t.put),o.head=n(t.head),o};var f=["get","put","post","head"];return f.forEach(function(e){var r=e.toUpperCase(),n=e.toLowerCase();t[n]=function(e){"string"==typeof e?e={method:r,uri:e}:(e=JSON.parse(JSON.stringify(e)),e.method=r);var n=[e].concat(Array.prototype.slice.apply(arguments,[1]));return t.apply(this,n)}}),t.couch=function(e,n){function o(t,e,r){if(t)return n(t,e,r);if((e.statusCode<200||e.statusCode>299)&&r.error){t=new Error("CouchDB error: "+(r.error.reason||r.error.error));for(var o in r)t[o]=r[o];return n(t,e,r)}return n(t,e,r)}"string"==typeof e&&(e={uri:e}),e.json=!0,e.body&&(e.json=e.body),delete e.body,n=n||r;var i=t(e,o);return i},t})},function(t,e,r){"use strict";function n(t,e){return e?o(t):encodeURIComponent(t)}var o=r(10);e.extract=function(t){return t.split("?")[1]||""},e.parse=function(t){var e=Object.create(null);return"string"!=typeof t?e:(t=t.trim().replace(/^(\?|#|&)/,""))?(t.split("&").forEach(function(t){var r=t.replace(/\+/g," ").split("="),n=r.shift(),o=r.length>0?r.join("="):void 0;n=decodeURIComponent(n),o=void 0===o?null:decodeURIComponent(o),void 0===e[n]?e[n]=o:Array.isArray(e[n])?e[n].push(o):e[n]=[e[n],o]}),e):e},e.stringify=function(t,e){e=e||{};var r=e.strict!==!1;return t?Object.keys(t).sort().map(function(e){var o=t[e];if(void 0===o)return"";if(null===o)return e;if(Array.isArray(o)){var i=[];return o.slice().sort().forEach(function(t){void 0!==t&&(null===t?i.push(n(e,r)):i.push(n(e,r)+"="+n(t,r)))}),i.join("&")}return n(e,r)+"="+n(o,r)}).filter(function(t){return t.length>0}).join("&"):""}},function(t,e){"use strict";t.exports=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}}])});
//# sourceMappingURL=esca.min.js.map